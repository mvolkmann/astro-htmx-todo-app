---
import TodoList from '@components/TodoList.astro';
import {clearCompleted, getTodos} from '@data/todos';
import TodoUpdate from '@pages/partials/_todo-update.astro';

export const partial = true;

if (Astro.request.method !== 'POST') {
  return Astro.redirect(null, 404);
}

clearCompleted();

const todos = getTodos(Astro.locals.filter);
---

<TodoUpdate>
  <TodoList {todos} />
</TodoUpdate>
